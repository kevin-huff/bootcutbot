<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/5a69a86b05.js" crossorigin="anonymous"></script>
    <title>Soundboard Dashboard</title>
  </head>
  <body>
    <audio id="tts" src="/tts"></audio>
    <audio id="lockedin" src="https://cdn.leantube.org/input_ok.mp3?v=1703768903507"></audio>
    <audio id="fart_01" src="https://cdn.leantube.org/dry-fart.mp3?v=1700004818800"></audio>
    <audio id="fart_02" src="https://cdn.leantube.org/fart_1.mp3?v=1700023345954"></audio>
    <audio id="fart_03" src="https://cdn.leantube.org/fart_03.mp3?v=1700023464386"></audio>  
    <audio id="fart_04" src="https://cdn.leantube.org/perfect-fart.mp3?v=1700023636828"></audio>
    <audio id="fart_05" src="https://cdn.leantube.org/fart-toot.mp3?v=1700023653624"></audio>
    <audio id="fart_06" src="https://cdn.leantube.org/fart-with-reverb_NcgStsA.mp3?v=1700023644773"></audio>
    <audio id="fart_07" src="https://cdn.leantube.org/fart3.mp3?v=1700023649738"></audio>
    <audio id="moan_01" src="https://cdn.leantube.org/moan-1.mp3?v=1706443774474"></audio>
    <audio id="moan_02" src="https://cdn.leantube.org/maon-2.mp3?v=1706443815977"></audio>
    <audio id="moan_03" src="https://cdn.leantube.org/maon-3.mp3?v=1706443854425"></audio>
    <audio id="moan_04" src="https://cdn.leantube.org/moan-4.mp3?v=1706443879906"></audio>
    <audio id="moan_05" src="https://cdn.leantube.org/moan_5.m4a?v=1706444485774"></audio>
    <audio id="boo_01" src="https://cdn.leantube.org/boo (1).mp3?v=1708155358672"></audio>
    <audio id="boo_02" src="https://cdn.leantube.org/boo (2).mp3?v=1708155358846"></audio>
    <audio id="boo_03" src="https://cdn.leantube.org/boo (3).mp3?v=1708155359060"></audio>
    <audio id="boo_04" src="https://cdn.leantube.org/boo (4).mp3?v=1708155359233"></audio>
    <audio id="boo_05" src="https://cdn.leantube.org/boo (5).mp3?v=1708155359406"></audio>
    <audio id="lightening_01" src="https://cdn.leantube.org/lightening (1).mp3?v=1708155707123"></audio>
    <audio id="lightening_02" src="https://cdn.leantube.org/lightening (2).mp3?v=1708155707454"></audio>
    <audio id="lightening_03" src="https://cdn.leantube.org/lightening (3).mp3?v=1708155707728"></audio>
    <audio id="gavel" src="https://cdn.leantube.org/gavel.mp3?v=1708155857036"></audio>
    <audio id="law_and_order" src="https://cdn.leantube.org/law_and_order.mp3?v=1708155852561"></audio>
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h1 class="text-center">Dashboard of the Gods</h1>
        </div>
      </div>
      <div class="row">
        <div class="col-lg-4">
          <button type="button" class="btn btn-info btn-lg btn-block" onclick="playSound('fart')">
            <i class="fa fa-bomb" aria-hidden="true"></i> Fart
          </button>
        </div>
        <div class="col-lg-4">
          <button type="button" class="btn btn-warning btn-lg btn-block" onclick="playSound('moan')">
            <i class="fa fa-cat" aria-hidden="true"></i> Maon
          </button>
        </div>
        <div class="col-lg-4">
          <button type="button" class="btn btn-danger btn-lg btn-block" onclick="playSound('boo')">
            <i class="fa fa-face-angry" aria-hidden="true"></i> Boo
          </button>
        </div>
        <div class="col-lg-4">
          <button type="button" class="btn btn-primary btn-lg btn-block" onclick="playSound('lightening')">
            <i class="fa fa-bolt" aria-hidden="true"></i> Lightening
          </button>
        </div>
        <div class="col-lg-4">
          <button type="button" class="btn btn-secondary btn-lg btn-block" onclick="playSound('gavel')">
            <i class="fa fa-gavel" aria-hidden="true"></i> Gavel
          </button>
        </div>
        <div class="col-lg-4">
          <button type="button" class="btn btn-success btn-lg btn-block" onclick="playSound('law_and_order')">
            <i class="fa fa-balance-scale" aria-hidden="true"></i> Law and Order
          </button>
        </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-lg-12">
          <form>
            <div class="form-group">
              <label for="godName">God's Name</label>
              <input type="text" class="form-control" id="godName" placeholder="Enter God's Name">
            </div>
            <button type="button" class="btn btn-danger btn-lg btn-block" onclick="vote('guilty')">Vote Guilty</button>
            <button type="button" class="btn btn-success btn-lg btn-block" onclick="vote('not-guilty')">Vote Innocent</button>
            <button type="button" class="btn btn-info btn-lg btn-block" onclick="giveVoteToChat()">Give Vote to Chat</button>
          </form>
        </div>
      </div>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script type="text/javascript">
        let audioContextInitialized = false;
        let isTTSPaused = false;
        // Event listener for user interaction
        document.addEventListener('click', function() {
            if (!audioContextInitialized) {
                initializeAudioContext();
            }
        });
        document.getElementById('tts').addEventListener('canplaythrough', function() {
            //toggleOverlay();    
            if (!isTTSPaused) {
                if (audioContextInitialized) {
                    this.play().catch(e => console.error('Error playing audio:', e));
                }
            }
        });
        $(document).ready(function() {
            var socket = io();
            socket.on("play_tts", function () {
                console.log("tts played");
                const tts_sound = document.getElementById(`tts`);
                tts_sound.src = "/tts?" + new Date().getTime();
                tts_sound.load();
            });
            socket.on("soundAlert", function (soundType) {
                // Get all audio elements with id that starts with the sound type
                var audioElements = Array.from(document.querySelectorAll(`audio[id^='${soundType}']`));
                
                if (audioElements.length > 0) {
                    // Select a random audio element from the list
                    var randomAudioElement = audioElements[Math.floor(Math.random() * audioElements.length)];
                    
                    // Play the selected audio
                    randomAudioElement.play().catch(e => console.error('Error playing audio:', e));
                }
            });
            // Function to emit 'play_sound' event
            window.playSound = function(soundType) {
                socket.emit('play_sound', { type: soundType }, function (response) {
                    console.log(response);
                });
            }
            // Function to emit 'vote' event
            window.vote = function(voteType) {
                // Make sure there's a god name
                if (!document.getElementById('godName').value) {
                    alert('Please enter your god\'s name');
                    return;
                }
                var godName = document.getElementById('godName').value;
                socket.emit('godVote', { vote: voteType, godName: godName }, function (response) {
                    console.log(response);
                });
            }
            // Function to emit 'give_vote_to_chat' event
            window.giveVoteToChat = function() {
                // Make sure there's a god name
                if (!document.getElementById('godName').value) {
                    alert('Please enter your god\'s name');
                    return;
                }
                var godName = document.getElementById('godName').value;
                socket.emit('godVote', { vote: 'giveToChat', godName: godName }, function (response) {
                    console.log(response);
                });
            }
        });
        // Function to initialize AudioContext and connect nodes
        function initializeAudioContext() {
        var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        var source = audioCtx.createMediaElementSource(document.getElementById('tts'));
        var gainNode = audioCtx.createGain();
        gainNode.gain.value = 4.5; // Set gain to 150%
        source.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        audioContextInitialized = true;
        }
    </script>
  </body>
</html>